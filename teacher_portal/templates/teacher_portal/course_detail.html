{% extends "teacher_portal/base.html" %}
{% load static %}
{% block extra_css %}
    <!-- Table CSS -->
    <link rel="stylesheet" href="{% static 'teacher_portal/css/dashboard.css' %}">
    <link rel="stylesheet" href="{% static 'teacher_portal/css/_status_indicators.css' %}">
    <link rel="stylesheet" href="{% static 'teacher_portal/css/sidebar.css' %}">
    <link rel="stylesheet" href="{% static 'teacher_portal/css/components.css' %}">
    <link rel="stylesheet" href="{% static 'teacher_portal/css/core.css' %}">
    <link rel="stylesheet" href="{% static 'teacher_portal/css/forms.css' %}">
    <link rel="stylesheet" href="{% static 'teacher_portal/css/styles.css' %}">
    <link rel="stylesheet" href="{% static 'teacher_portal/css/tables.css' %}">
    <style>
        .student-assignments-progress {
            width: 120px;
            display: inline-block;
        }
        .course-header {
            border-bottom: 2px solid var(--primary);
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
        }
    </style>
{% endblock %}

{% block content %}
<div class="course-header">
    <h2>{{ course.title }}</h2>
    <p><strong>Code:</strong> {{ course.code }}</p>
</div>

<h3>Assignments</h3>
<table class="styled-table">
    <thead>
        <tr>
            <th>Title</th>
            <th>Due Date</th>
            <th>Submissions</th>
            <th>Graded</th>
        </tr>
    </thead>
    <tbody>
        {% for assignment in assignments %}
        <tr>
            <td>{{ assignment.title }}</td>
            <td>{{ assignment.due_date }}</td>
            <td>{{ assignment.submissions_count }}</td>
            <td>{{ assignment.graded_count }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4" style="text-align: center;">No assignments found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h3>Enrolled Students</h3>
<table class="styled-table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Assignments Submitted</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for student in students %}
        <tr>
            <td>{{ student.user.get_full_name }}</td>
            <td>{{ student.user.email }}</td>
            <td>
                <span class="student-assignments-progress">
                    {{ student.assignment_count }}
                </span>
            </td>
            <td>
                <a href="{% url 'remove_student_from_course' course.id student.id %}"
                   class="btn btn-sm btn-danger"
                   onclick="return confirm('Remove this student from the course?');">
                   Remove
                </a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4" style="text-align: center;">No students enrolled.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<a href="{% url 'add_student_to_course' course.id %}" class="btn btn-success">Add Student</a>
{% endblock %}
